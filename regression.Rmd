---
title: "Regression between Mental Health and Physical Health"
output: 
  html_document:
    toc: true
    toc_float: true
    theme: flatly
---

```{r setup, include=FALSE}
library(flexdashboard)
library(tidyverse)
library(patchwork)
library(ggridges)
library(viridis)

library(plotly)
```

```{r, message=FALSE, echo= FALSE}
# read in the data
mental = read.csv("./data/health data.csv")%>% 
  janitor::clean_names() %>% 
  as_tibble() %>% 
  filter(measure == "mental health" | measure == "obesity" | measure == "diabetes" | measure == "drink" | measure == "cancer" | measure == "sleeping") 

mental_data = mental %>%
  filter(measure == "mental health")  
```

```{r}
#deal with data
total_data = mental %>% 
  pivot_wider(names_from = measure, city_name, values_from = data_value) %>% 
  unnest() %>% 
  drop_na() %>% 
  group_by(city_name) %>% 
  summarize(obesity = mean(obesity), drink = mean(drink), diabetes = mean(diabetes), mental_health = mean(`mental health`), cancer = mean(cancer), sleeping = mean(sleeping))


```


### Drink
```{r, warning=FALSE, echo=FALSE}
# Drink 

drink_plot = 
  plot_ly(x = total_data$drink, y = total_data$mental_health, 
       type = "scatter",
        mode = "markers",alpha = .5)
drink_lm = lm(total_data$mental_health ~ total_data$drink, total_data)

drink_plot
summary(drink_lm)

```


### Diabetes
```{r, warning=FALSE, echo=FALSE}
# Diabetes
diabetes_plot = 
  plot_ly(x = total_data$diabetes, y = total_data$mental_health, 
       type = "scatter",  color =  "Yellow",
        mode = "markers",alpha = .5)
diabetes_lm = lm(total_data$mental_health ~ total_data$diabetes)

diabetes_plot
summary(diabetes_lm)
```


### Cancer
```{r, warning=FALSE, echo=FALSE}
# Cancer
cancer_plot = 
  plot_ly(x = total_data$cancer, y = total_data$mental_health, 
       type = "scatter",
        mode = "markers",alpha = .5) 
cancer_lm = lm(total_data$mental_health ~ total_data$cancer)

cancer_plot
summary(cancer_lm)
```


### Obesity
```{r, warning=FALSE, echo=FALSE}
# Obesity
obe_plot = 
  plot_ly(x = total_data$obesity, y = total_data$mental_health, 
       type = "scatter", 
        mode = "markers",alpha = .5)
obe_lm = lm(total_data$mental_health ~ total_data$obesity)

obe_plot
summary(obe_lm)
```


### Sleeping
```{r}
#sleeping
sleep_plot = 
  plot_ly(x = total_data$sleeping, y = total_data$mental_health, 
       type = "scatter", 
        mode = "markers",alpha = .5)
sleep_lm = lm(total_data$mental_health ~ total_data$sleeping)

sleep_plot
summary(sleep_lm)
```

**Analysis:**

To make inferences of the relationships between mental health and four factors including obesity, diabetes, drinking and cancer, we build four linear regression models and plot them. Based on the observations from the four regression models, diabetes and obesity have positive association with mental health. For diabetes, we can see from the plot that there is an positive linear relationship and the regression model is $Y = 0.5985X + 6.7551$. As for the obesity, we can also see a salient positive relationship and the linear regression model is $Y = 0.26779X + 4.97108$. The positive relationships of diabetes and mental health and obesity and mental health implies that people who with obesity and diabetes are more likely to have mental health issues. 

However, from the plots of drinking and cancer, we can see a slightly negative relationship. To test if the negative relationship between mental health and drinking is significant or not, we perform a t-test: By using 0.05 significance level, p-value is less than 2e-16, so we can conclude that the negative relationship between mental health and drinking is significant and the regression model is $Y = -0.30765X + 0.03355$. For the relationship between mental health and cancer, p-value is 0.00149 < 0.05 so we can also conclude that the negative relationship is significant. 



